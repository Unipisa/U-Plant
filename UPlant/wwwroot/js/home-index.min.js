function PerformSearch(){var n=$("#search").val();n!=""&&(ClearSearchTeachingsTable(),$.ajax({url:baseApiUrl+"Search/"+n,dataType:"json"}).done(function(n){$.each(n,function(n,t){subscribeBoxText=MakeSubscribeBox(t.id,t.subscription);teachingText=MakeTeachingText(t.valutamiID,t.name);$("#SearchTeachingsTable > tbody").append("<tr><td>"+t.courseName+"<\/td><td>"+teachingText+"<br />"+t.teacherName+" "+t.teacherSurname+"<\/td><td>"+t.code+"<\/td><td>"+t.cfu+"<\/td><td>"+subscribeBoxText+"<\/td><\/tr>")});$("#SearchTeachings").show()}).fail(function(n,t,i){alert("Errore di comunicazione: "+i)}))}function SubControlFired(n){n.preventDefault();var t=$("#"+n.target.id),i=t.data("sub");t.is(":checked")?i!=""?alert("Sei gia' iscritto a questo insegnamento"):Subscribe(t):t.data("sub")==""?alert("Non risulti iscritto a questo insegnamento"):UnSubscribe(t)}function Subscribe(n){var t=n.data("teaching");$.ajax({url:baseApiUrl+"Subscribe/"+t,method:"POST",dataType:"json"}).done(function(t){t.success?(n.data("sub",t.subscribeId),n.prop("checked",!0)):window.alert(t.errorMessage)}).fail(function(n,t,i){alert("Errore di comunicazione: "+i)})}function UnSubscribe(n){var t=n.data("sub");$.ajax({url:baseApiUrl+"UnSubscribe/"+t,method:"DELETE",dataType:"json"}).done(function(t){t.success?(n.data("sub",""),n.prop("checked",!1)):window.alert(t.errorMessage)}).fail(function(n,t,i){alert("Errore di comunicazione: "+i)})}function FillAllTables(){FillCurrentCourseTable();RefreshOtherTeachingsTable()}function FillCurrentCourseTable(){$.ajax({url:baseApiUrl+"MyCourses",dataType:"json"}).done(function(n){$.each(n,function(n,t){subscribeBoxText=MakeSubscribeBox(t.id,t.subscription);teachingText=MakeTeachingText(t.valutamiID,t.name);$("#CurrentCourseTable > tbody").append("<tr><td>"+t.courseName+"<\/td><td>"+teachingText+"<br />"+t.teacherName+" "+t.teacherSurname+"<\/td><td>"+t.code+"<\/td><td>"+t.cfu+"<\/td><td>"+subscribeBoxText+"<\/td><\/tr>")})}).fail(function(n,t,i){alert("Errore di comunicazione: "+i)})}function RefreshOtherTeachingsTable(){ClearOtherTeachingsTable();$.ajax({url:baseApiUrl+"OtherCourses",dataType:"json"}).done(function(n){var t=0;$.each(n,function(n,i){t=1;subscribeBoxText=MakeSubscribeBox(i.id,i.subscription);teachingText=MakeTeachingText(i.valutamiID,i.name);$("#OtherTeachingsTable > tbody").append("<tr><td>"+i.courseName+"<\/td><td>"+teachingText+"<br />"+i.teacherName+" "+i.teacherSurname+"<\/td><td>"+i.code+"<\/td><td>"+i.cfu+"<\/td><td>"+subscribeBoxText+"<\/td><\/tr>")});t>0&&$(".OtherTeachings").show()}).fail(function(n,t,i){alert("Errore di comunicazione: "+i)})}function MakeTeachingText(n,t){return n==null?t:"<a href='https://esami.unipi.it/programma.php?c="+n+"' target='_blank'>"+t+"<\/a>"}function MakeSubscribeBox(n,t){return controlId="sub_"+n,chkdStatus=t==null?"":" checked ",chkdData=' data-sub="'+(t==null?"":t)+'" ',ret='<div class="form-check form-switch sub-control"><input class="form-check-input" type="checkbox" data-teaching="'+n+'" id="'+controlId+'"'+chkdStatus+chkdData+"><\/div>"}function ClearAllTables(){ClearCurrentCourseTable();ClearSearchTeachingsTable()}function ClearCurrentCourseTable(){$("#CurrentCourseTable tbody").empty()}function ClearSearchTeachingsTable(){$("#SearchTeachings").hide();$("#SearchTeachingsTable tbody").empty()}function ClearOtherTeachingsTable(){$(".OtherTeachings").hide();$("#OtherTeachingsTable tbody").empty()}var baseApiUrl="api/ADApi/";$(function(){ClearAllTables();FillAllTables();$("#btnSearch").click(function(){PerformSearch()})});$(document.body).on("click",".sub-control",function(n){SubControlFired(n)});